2022-03-31-12_36_12
lr:  0.0003  rec:  0.007  dropout:  0.0  batchsize:  512  epoch:  200  dev_ratio:  0.2  test_ratio:  0.2
train_size:  20259 dev_size:  6753 test_size:  6753
device:  cpu
[Epoch 1]train_loss:  1.2276299208402635
[Epoch 1]dev_loss:  0.5157493289027896
p5-10-20: 0.0021620020731526702 0.0018066044720864765 0.003583592477417471
r5-10-20: 0.0017744222862209637 0.003192261766155509 0.011240832665327412
f1_5-10-20:  0.0019491316540734968 0.002307384958042028 0.005434620633342881
Validation loss decreased (inf --> 0.515749).  Saving model ...
[Epoch 2]train_loss:  0.35070797950029375
[Epoch 2]dev_loss:  0.23110511153936386
p5-10-20: 0.031956167629201386 0.022449281800680704 0.01494150747815745
r5-10-20: 0.025049031214578646 0.03505100329851379 0.04602106961926809
f1_5-10-20:  0.028084141680986704 0.0273692503988847 0.022558893951253555
Validation loss decreased (0.515749 --> 0.231105).  Saving model ...
[Epoch 3]train_loss:  0.1754376545548439
[Epoch 3]dev_loss:  0.14309902489185333
p5-10-20: 0.04279579446171996 0.03475492373759735 0.02347104990374639
r5-10-20: 0.034050544836134115 0.053385284841602994 0.07148224812976078
f1_5-10-20:  0.03792555719451354 0.042101137115202227 0.0353387075084381
Validation loss decreased (0.231105 --> 0.143099).  Saving model ...
[Epoch 4]train_loss:  0.1187064616009593
[Epoch 4]dev_loss:  0.10779629541294915
p5-10-20: 0.05455353176365949 0.04033762772101217 0.028727972752850862
r5-10-20: 0.041621514535464144 0.06131805775188188 0.0875685754255247
f1_5-10-20:  0.04721808208332285 0.04866279686497275 0.04326298051374228
Validation loss decreased (0.143099 --> 0.107796).  Saving model ...
[Epoch 5]train_loss:  0.09364013951271773
[Epoch 5]dev_loss:  0.09081672451325826
p5-10-20: 0.05973641344587451 0.04358063083074145 0.02978676143936058
r5-10-20: 0.045207201095931 0.06528962935009269 0.08946119195719832
f1_5-10-20:  0.051466038542420704 0.0522707161543208 0.04469274494038522
Validation loss decreased (0.107796 --> 0.090817).  Saving model ...
[Epoch 6]train_loss:  0.08019468318670989
[Epoch 6]dev_loss:  0.0805573511336531
p5-10-20: 0.06645935139937625 0.0501851029172221 0.036235747075374476
r5-10-20: 0.05057944778979189 0.07472570569132685 0.10906227190443213
f1_5-10-20:  0.057442101551506926 0.06004471946748129 0.054397891009666716
Validation loss decreased (0.090817 --> 0.080557).  Saving model ...
[Epoch 7]train_loss:  0.0717313664034009
[Epoch 7]dev_loss:  0.07303662784397602
p5-10-20: 0.088316303864948 0.06340885532356093 0.047608470309493334
r5-10-20: 0.06816821790017334 0.09627856555631725 0.1429554964138821
f1_5-10-20:  0.0769451825406252 0.07646079572803645 0.07142895504977724
Validation loss decreased (0.080557 --> 0.073037).  Saving model ...
[Epoch 8]train_loss:  0.0658051036298275
[Epoch 8]dev_loss:  0.06912193367523807
p5-10-20: 0.08342958685028748 0.0627276765881842 0.04712720272471607
r5-10-20: 0.06442193524185146 0.09623887319898167 0.14076067113563664
f1_5-10-20:  0.07270395820437443 0.07595108431699228 0.07061293044598672
Validation loss decreased (0.073037 --> 0.069122).  Saving model ...
[Epoch 9]train_loss:  0.06209472678601742
[Epoch 9]dev_loss:  0.06488430313766003
p5-10-20: 0.10259144084110805 0.0775655264326983 0.057470753739080685
r5-10-20: 0.07820704849608208 0.11737780839146783 0.1708760508277211
f1_5-10-20:  0.08875487642128914 0.09340633787359719 0.08601281244686206
Validation loss decreased (0.069122 --> 0.064884).  Saving model ...
[Epoch 10]train_loss:  0.059106072690337894
[Epoch 10]dev_loss:  0.06122698847736631
p5-10-20: 0.1284762327854308 0.09671257219014072 0.06994669035984225
r5-10-20: 0.09914952964766865 0.14639671164720242 0.20979621912319676
f1_5-10-20:  0.11192369365763802 0.11647767884542327 0.10491455318591615
Validation loss decreased (0.064884 --> 0.061227).  Saving model ...
[Epoch 11]train_loss:  0.05664071813225746
[Epoch 11]dev_loss:  0.05932064301201275
p5-10-20: 0.13733155634533112 0.10205834443951213 0.07336739227010432
r5-10-20: 0.1070493041641667 0.15573354950942447 0.21940108998003646
f1_5-10-20:  0.1203142301397402 0.1233080528107122 0.10996324269150765
Validation loss decreased (0.061227 --> 0.059321).  Saving model ...
[Epoch 12]train_loss:  0.054813585709780455
[Epoch 12]dev_loss:  0.05797780544630119
p5-10-20: 0.13472530727084583 0.10687102028728344 0.07569968902710116
r5-10-20: 0.10295605510565627 0.16207146137954576 0.22580204887426858
f1_5-10-20:  0.11671749118911268 0.1288062959018421 0.11338670881592357
Validation loss decreased (0.059321 --> 0.057978).  Saving model ...
[Epoch 13]train_loss:  0.05330024696886539
[Epoch 13]dev_loss:  0.05642594317240374
p5-10-20: 0.14500222123501041 0.11224640900341028 0.08097882422627158
r5-10-20: 0.11122385001636755 0.1699071032293073 0.24177643695242054
f1_5-10-20:  0.1258865284700408 0.13518500656426177 0.12132271070356634
Validation loss decreased (0.057978 --> 0.056426).  Saving model ...
[Epoch 14]train_loss:  0.051560765318572524
[Epoch 14]dev_loss:  0.05419635746095862
p5-10-20: 0.16543758329631747 0.1256774766770369 0.09055234710499152
r5-10-20: 0.12775150764831888 0.19038781816082564 0.27057383800582385
f1_5-10-20:  0.1441724903180838 0.1514083385128761 0.13569271410827163
Validation loss decreased (0.056426 --> 0.054196).  Saving model ...
[Epoch 15]train_loss:  0.050094880536198615
[Epoch 15]dev_loss:  0.053548104262777736
p5-10-20: 0.16197245668592264 0.12342662520361757 0.09039686065452474
r5-10-20: 0.12472637410588343 0.1875545287504162 0.2702025631389803
f1_5-10-20:  0.14093002871100463 0.14887862001266475 0.13547145024030952
Validation loss decreased (0.054196 --> 0.053548).  Saving model ...
[Epoch 16]train_loss:  0.04908393481746316
[Epoch 16]dev_loss:  0.05218320047216756
p5-10-20: 0.18519176662224884 0.14226269806012617 0.10374648304457297
r5-10-20: 0.14269252783182912 0.2140699653788214 0.31162030063656615
f1_5-10-20:  0.1611878443702879 0.17093112124220555 0.15566728735414032
Validation loss decreased (0.053548 --> 0.052183).  Saving model ...
[Epoch 17]train_loss:  0.04798811320215464
[Epoch 17]dev_loss:  0.05102915715958391
p5-10-20: 0.18572486302384847 0.14288464386199196 0.10456093588034934
r5-10-20: 0.14353056200605305 0.21599836464221134 0.3118093163537241
f1_5-10-20:  0.1619240986895278 0.17199392936043653 0.1566061636690645
Validation loss decreased (0.052183 --> 0.051029).  Saving model ...
[Epoch 18]train_loss:  0.04766987338662147
[Epoch 18]dev_loss:  0.05117858600403581
p5-10-20: 0.17823189693470193 0.13454760847031383 0.09867466311269088
r5-10-20: 0.1358031736477502 0.20191303658742044 0.29273295274538147
f1_5-10-20:  0.15415130038877925 0.16148644182232172 0.14759715612994334
EarlyStopping counter: 1 out of 7
[Epoch 19]train_loss:  0.04717162130400539
[Epoch 19]dev_loss:  0.05051215658230441
p5-10-20: 0.1686657781726688 0.12863912335258793 0.09715681919147091
r5-10-20: 0.12916664483094972 0.19337166175660053 0.2883985977258415
f1_5-10-20:  0.14629698435548005 0.15449893109114202 0.1453481869783991
Validation loss decreased (0.051029 --> 0.050512).  Saving model ...
[Epoch 20]train_loss:  0.04645490031689405
[Epoch 20]dev_loss:  0.049890215641685894
p5-10-20: 0.16478602102769618 0.13040130312454135 0.09489856360136302
r5-10-20: 0.12717588588501097 0.19816644185749296 0.28348957064332475
f1_5-10-20:  0.14355851026772437 0.15729579454109738 0.1421965998152292
Validation loss decreased (0.050512 --> 0.049890).  Saving model ...
[Epoch 21]train_loss:  0.04537046495825052
[Epoch 21]dev_loss:  0.04880128587995257
p5-10-20: 0.19327706204650533 0.15313194135940011 0.10987709166296446
r5-10-20: 0.148837387959159 0.2319992465177219 0.3267337938649793
f1_5-10-20:  0.16817093266266575 0.18449035617703588 0.16445104878441955
Validation loss decreased (0.049890 --> 0.048801).  Saving model ...
[Epoch 22]train_loss:  0.04443267146125436
[Epoch 22]dev_loss:  0.04900809883006981
p5-10-20: 0.1764845253961261 0.13503628017177982 0.09585369465422815
r5-10-20: 0.13560403391078646 0.20439242167494065 0.28771647461536637
f1_5-10-20:  0.15336681113646702 0.1626285117794283 0.14379995794397288
EarlyStopping counter: 1 out of 7
[Epoch 23]train_loss:  0.044080162141472104
[Epoch 23]dev_loss:  0.049727006150143485
p5-10-20: 0.17035391677773315 0.12966089145565304 0.09243299274396567
r5-10-20: 0.12967361392573598 0.19492108989121756 0.275694113308361
f1_5-10-20:  0.14725587337382262 0.15573040853297285 0.13844800644132194
EarlyStopping counter: 2 out of 7
[Epoch 24]train_loss:  0.043597576301544906
[Epoch 24]dev_loss:  0.0486028827726841
p5-10-20: 0.17891307567007847 0.1374204057455988 0.09741596327558141
r5-10-20: 0.13589598903327443 0.20632385122489452 0.28907078580345236
f1_5-10-20:  0.15446549731389425 0.1649662897655051 0.14572354224805129
Validation loss decreased (0.048801 --> 0.048603).  Saving model ...
[Epoch 25]train_loss:  0.042992524616420266
[Epoch 25]dev_loss:  0.04748486301728657
p5-10-20: 0.193040130312461 0.1464682363394094 0.10604175921812499
r5-10-20: 0.1463092972219216 0.22021771500749815 0.31482295205792754
f1_5-10-20:  0.16645712949537478 0.17592656718565705 0.1586466091549345
Validation loss decreased (0.048603 --> 0.047485).  Saving model ...
[Epoch 26]train_loss:  0.04309028536081314
[Epoch 26]dev_loss:  0.046255050493138175
p5-10-20: 0.1980453131941436 0.1575596031393491 0.11504516511180132
r5-10-20: 0.1489398764382608 0.23431062553737333 0.33905389750411374
f1_5-10-20:  0.1700178875504907 0.18841895336452094 0.17179736683642677
Validation loss decreased (0.047485 --> 0.046255).  Saving model ...
[Epoch 27]train_loss:  0.04318770132958889
[Epoch 27]dev_loss:  0.046003292713846476
p5-10-20: 0.19777876499334382 0.15803346660743747 0.11556345328002295
r5-10-20: 0.15018234521001148 0.2362879407540963 0.34174934500784554
f1_5-10-20:  0.17072527870756946 0.1893957654734007 0.17272087994538704
Validation loss decreased (0.046255 --> 0.046003).  Saving model ...
[Epoch 28]train_loss:  0.042406901624053715
[Epoch 28]dev_loss:  0.04656106872217996
p5-10-20: 0.19934843773138616 0.15328002369317767 0.1117281208351842
r5-10-20: 0.15146790036736713 0.2294165182597176 0.3301158964378566
f1_5-10-20:  0.17214072450741763 0.18377469090784196 0.16695135534232383
EarlyStopping counter: 1 out of 7
[Epoch 29]train_loss:  0.042922433000057936
[Epoch 29]dev_loss:  0.048040423542261124
p5-10-20: 0.1740855915889281 0.13419221086924626 0.09682363394047142
r5-10-20: 0.13400221666450654 0.20087728492386334 0.287656339068248
f1_5-10-20:  0.1514364057085385 0.16089896165290388 0.14488105508663926
EarlyStopping counter: 2 out of 7
[Epoch 30]train_loss:  0.042192534636706115
[Epoch 30]dev_loss:  0.04878938916538443
p5-10-20: 0.16460832222716243 0.12277506293499559 0.08576928772397535
r5-10-20: 0.1260173224762423 0.18653139894761286 0.25574660875926686
f1_5-10-20:  0.14275065124095282 0.14808228774625692 0.1284578826167433
EarlyStopping counter: 3 out of 7
[Epoch 31]train_loss:  0.041738819982856515
[Epoch 31]dev_loss:  0.04877291353685515
p5-10-20: 0.16274248482156486 0.12418184510588182 0.0873093439952623
r5-10-20: 0.12463617991985398 0.18587843145986294 0.2599983954127567
f1_5-10-20:  0.1411628913863083 0.1488918660573477 0.1307214712922573
EarlyStopping counter: 4 out of 7
[Epoch 32]train_loss:  0.04126152591779828
[Epoch 32]dev_loss:  0.0485383224274431
p5-10-20: 0.1686953946394242 0.12572190137716874 0.0880127350807058
r5-10-20: 0.12898287956872767 0.18776155845609102 0.2614200896961587
f1_5-10-20:  0.14619016337990226 0.15060277915261253 0.1316893861582012
EarlyStopping counter: 5 out of 7
[Epoch 33]train_loss:  0.04094673516228795
[Epoch 33]dev_loss:  0.04750574380159378
p5-10-20: 0.17755071819932472 0.12960165852214198 0.0921294239597222
r5-10-20: 0.1360695800538286 0.1947581857526825 0.27439705654198254
f1_5-10-20:  0.15406688787808503 0.15563568875632477 0.13794388182183032
EarlyStopping counter: 6 out of 7
[Epoch 34]train_loss:  0.040429648105055095
[Epoch 34]dev_loss:  0.046317742871386666
p5-10-20: 0.1920035539760176 0.1456241670368763 0.10316155782615126
r5-10-20: 0.14742357113719226 0.21797942327980213 0.3061621748905797
f1_5-10-20:  0.16678601976037077 0.17460263205126603 0.15432365330746464
EarlyStopping counter: 7 out of 7
Early stopping
2022-03-31-13_38_52
----------------------------------------------------------------------------------------------------
test_loss:  0.05290747354073184
p5-10-20: 0.1675995853694716 0.13642825410928935 0.10048126758477684
r5-10-20: 0.11900883988747439 0.19202156637271336 0.27855335213418164
f1_5-10-20:  0.139185246927483 0.1595200570553868 0.1476877966091038
